# Composite
* 容器と中身を同一視し，再帰的な構造を作るデザインパターン

## 何故Compositeを使うか
* ディレクトリの中にはディレクトリ(サブディレクトリ)やファイルが入っており，さらにサブディレクトリにはファイルやサブディレクトリが入っていることがある
* ディレクトリはこうした「入れ子」になった構造，再帰的な構造を作り出している
* ディレクトリとファイルは異なるものだが，このどちらも「ディレクトリの中に入れることが出来るもの」
* ディレクトリとファイルをまとめて，「ディレクトリエントリ」と呼ぶことが出来る
* ディレクトリエントリ，という名前によってディレクトリとファイルを同じ種類のものであると見なしている

## Compositeパターンの登場人物
* Leaf(葉)の役
    * 中身を表す役
        * この中には他のものを入れることが出来ない
    * Fileクラスがこの役
* Composite(複合体)の役
    * 容器を表す役
        * Leaf役やComposite役を入れられる
        * Dictionaryクラスがこの役
* Componentの役
    * Leaf役とComposite役を同一視するためのクラス
    * Leaf役とComposite約の共通のスーパークラスとして実現
    * Entryクラスがこの役
* Client(依頼者)の役
    * Compositeパターンの利用者
    * Mainクラスがこの役


## あなたの考えを広げるためのヒント
### 複数と単数の同一視
* Compositeパターンは**複数と単数の同一視**と呼ぶことも出来る
    * Test1：キーボード入力テスト，Test2：ファイル入力テスト，Test3：ネットワーク入力テスト
    * この3つをまとめて入力テストとしたいとする，
    * Compositeパターンでは複数のテストを集めて入力テストとし，別のテストをまとめて出力テストとし，両者をまとめて入出力テストとする
        * Kent Beck Testing Framework入門

### addはどこに置くべきか
* addメソッドが実際に使えるのはDictionaryクラスだけだが，addメソッドの置き方，実装の仕方はたくさんある
1. Entryクラスに実装し，エラーにする
    * addメソッドをEntryクラスで実装し，エラーにするのがサンプルプログラム
    * Dictionaryクラスでaddをオーバーライドして意味のある実装に置き換える
    * Fileクラスからaddを使用すると例外が投げられる
2. Entryクラスに実装し，何も行わない
    * 実装するがエラーにしない
3. Entryクラスで宣言はするが，実装はしない
    * addメソッドをEntryクラスでは抽象メソッドとし，サブクラスでは必要なら定義し，不要ならエラーにする
4. Directoryクラスだけに入れる
    * ほんとうに必要なDictionaryクラスで初めて入れる
    * ただし，このやり方だと，Entry型の変数にaddするとき，いちいちDirectory型にキャストする必要が生じる

### 再帰的構造はあらゆる場面で登場する
* ウィンドウシステムではウィンドウの中に子ウィンドウを持たせるが，これはCompositeパターンの典型例
* 箇条書きも再帰的構造
* マクロコマンドを再帰的な構造として実装すると，マクロコマンドのマクロコマンドを作れる
* 一般に木構造になるデータ構造はCompositeパターンに当てはまる
